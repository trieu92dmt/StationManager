@using Newtonsoft.Json;
@using ISD.Repositories;
@using System.Drawing;

@model IEnumerable<BC03ReportViewModel>

@{
    var pivotSetting = (List<FieldSettingModel>)ViewBag.PivotSetting;
    var search = (BC03ReportViewModel)ViewBag.Search;
    var NumberOfFreezeColumn = (int?)ViewBag.NumberOfFreezeColumn;
    UtilitiesRepository repo = new UtilitiesRepository();
    string fileName = repo.RemoveSign4VietnameseString(LanguageResource.BC03Report.ToUpper()).Replace(" ", "_").Replace("/", "_");
    Html.EnableClientValidation();
    Html.EnableUnobtrusiveJavaScript();
}

@Html.DevExpress().GridView(settings =>
{
    settings.Name = "gridViewBC03";
    settings.KeyFieldName = "LSX";
    settings.Width = Unit.Percentage(100);
    settings.CallbackRouteValues = new { Controller = "BC03Report", Action = "BC03ReportPartial", jsonReq = JsonConvert.SerializeObject(search) };
    //Command Column: CRUD
    settings.CommandColumn.Visible = false;

    //Fixed Column
    settings.Styles.FixedColumn.BackColor = Color.LightYellow;
    settings.Settings.HorizontalScrollBarMode = ScrollBarMode.Visible;

    //Fixed Header
    settings.Settings.VerticalScrollBarMode = ScrollBarMode.Visible;
    settings.Settings.VerticalScrollableHeight = 500;

    settings.SettingsPager.Mode = GridViewPagerMode.ShowAllRecords;

    settings.Columns.Add(c =>
    {
        c.FieldName = "STT";
        c.Width = Unit.Pixel(70);
        c.Caption = "Thứ tự ưu tiên";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 70;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "VBELN";
        c.Width = Unit.Pixel(100);
        c.Caption = "SO";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 80;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "PYCSXDT";
        c.Width = Unit.Pixel(160);
        c.Caption = "PYCSXDT/ PO nội bộ";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 200;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "LSXDT";
        c.Width = Unit.Pixel(160);
        c.Caption = "LSXĐT";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 200;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "DSX";
        c.Width = Unit.Pixel(160);
        c.Caption = "LSXĐT-Đợt";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 200;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "KLTGo";
        c.Width = Unit.Pixel(100);
        c.Caption = "KL tinh (gỗ)";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "DeliveryDate";
        c.Width = Unit.Pixel(100);
        c.Caption = "Ngày giao hàng";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "FinishDateChange";
        c.Width = Unit.Pixel(100);
        c.Caption = "Ngày hoàn thành DC";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLKH";
        c.Width = Unit.Pixel(100);
        c.Caption = "Số cont KH";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "NK";
        c.Width = Unit.Pixel(100);
        c.Caption = "Số cont NK";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "Remaining";
        c.Width = Unit.Pixel(100);
        c.Caption = "Số cont còn lại";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "NKTrongThang";
        c.Width = Unit.Pixel(100);
        c.Caption = "NK trong tháng";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "NKLuyKeThangTruoc";
        c.Width = Unit.Pixel(100);
        c.Caption = "NK lũy kế tháng trước";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "TinhTrangNVL";
        c.Width = Unit.Pixel(100);
        c.Caption = "Tình trạng NVL";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 100;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentGo";
        c.Width = Unit.Pixel(100);
        c.Caption = "Gỗ";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentVan";
        c.Width = Unit.Pixel(100);
        c.Caption = "Ván, veneer";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentGiaCong";
        c.Width = Unit.Pixel(100);
        c.Caption = "Gia công";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentVatTu";
        c.Width = Unit.Pixel(100);
        c.Caption = "Vật tư";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentHoaChat";
        c.Width = Unit.Pixel(100);
        c.Caption = "Hóa chất";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentBBPL";
        c.Width = Unit.Pixel(100);
        c.Caption = "BBPL, tem nhãn";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "AssignResponsibility";
        c.Width = Unit.Pixel(100);
        c.Caption = "PIC_TDSX";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 100;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "TinhTrangLSX";
        c.Width = Unit.Pixel(100);
        c.Caption = "Tình trạng LSX";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 100;
    });

    //Phân xưởng phôi
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX Phôi";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXP_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXP_SoContHT";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont HT";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXP_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXP_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXP_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng mẫu
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX Mẫu";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXM_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXM_SoContHT";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont HT";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXM_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXM_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXM_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 4
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX4";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX4_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX4_SoContHT";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont HT";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX4_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX4_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX4_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 5
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX5";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX5_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX5_SoContHT";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont HT";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX5_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX5_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX5_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 3
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX3";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX3_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX3_SoContHT";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont HT";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX3_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX3_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX3_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 6
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX6";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX6_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX6_SoContHT";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont HT";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX6_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX6_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX6_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng Cửa
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX Cửa";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXC_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXC_SoContHT";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont HT";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXC_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXC_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXC_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 1
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX1";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX1_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX1_SoContHT";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont HT";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX1_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX1_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX1_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Export excel
    if (Model != null && Model.Count() > 0)
    {
        settings.SettingsExport.EnableClientSideExportAPI = true;
        settings.SettingsExport.ExcelExportMode = DevExpress.Export.ExportType.WYSIWYG;

        settings.Toolbars.Add(t =>
        {
            t.SettingsAdaptivity.Enabled = true;
            t.SettingsAdaptivity.EnableCollapseRootItemsToIcons = true;
            t.Items.Add(GridViewToolbarCommand.ExportToXls);
            t.Items.Add(GridViewToolbarCommand.ExportToXlsx);
        });

        //File name
        settings.SettingsExport.FileName = fileName;
        //Page header
        //settings.SettingsExport.ReportHeader = LanguageResource.BC00Report.ToUpper();
        settings.SettingsExport.PageHeader.Left = LanguageResource.BC03Report.ToUpper();
        settings.SettingsExport.PageHeader.Font.Size = 16;
        settings.SettingsExport.PageHeader.Font.Bold = true;
        //Column header
        settings.SettingsExport.Styles.Header.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        settings.SettingsExport.Styles.Header.ForeColor = ColorTranslator.FromHtml("#000000");
        settings.SettingsExport.Styles.Header.Font.Size = 11;
        settings.SettingsExport.Styles.Header.Font.Bold = true;
        //Cell
        settings.SettingsExport.Styles.Cell.Font.Size = 11;
    }
    Reports.Helpers.GridViewFeaturesHelper.SetupGlobalGridViewBehavior(settings);
}).Bind(Model).GetHtml()

@*@Html.DevExpress().PivotGrid(settings =>
    {
        settings.Name = "BC03Report";
        settings.CallbackRouteValues = new { Controller = "BC03Report", Action = "BC03ReportPartial", jsonReq = JsonConvert.SerializeObject(search) };
        settings.Width = Unit.Percentage(100);
        settings.OptionsPager.RowsPerPage = 10;
        settings.OptionsPager.PageSizeItemSettings.Visible = true;
        //Grand total
        settings.OptionsView.ShowRowTotals = false;
        settings.OptionsView.ShowColumnGrandTotalHeader = false;
        settings.OptionsView.ShowColumnGrandTotals = false;
        settings.OptionsView.ShowRowGrandTotalHeader = false;
        settings.OptionsView.ShowRowGrandTotals = false;
        settings.OptionsView.ShowTotalsForSingleValues = false;
        settings.OptionsView.ShowGrandTotalsForSingleValues = false;
        settings.OptionsView.ShowCustomTotalsForSingleValues = false;
        //Customization
        settings.OptionsCustomization.AllowDrag = true;
        settings.OptionsCustomization.AllowDragInCustomizationForm = true;
        settings.OptionsCustomization.AllowSort = false;
        settings.OptionsCustomization.AllowExpand = false;
        //Scroll
        settings.OptionsView.HorizontalScrollingMode = PivotScrollingMode.Virtual;
        settings.OptionsView.HorizontalScrollBarMode = ScrollBarMode.Auto;
        settings.AfterPerformCallback = (sender, e) =>
        {
            List<FieldSettingModel> fieldSettingList = new List<FieldSettingModel>();
            ASPxPivotGrid PivotGrid = sender as ASPxPivotGrid;
            var listField = PivotGrid.Fields;
            foreach (PivotGridField field in listField)
            {
                FieldSettingModel fieldSetting = new FieldSettingModel();
                fieldSetting.Caption = field.Caption;
                fieldSetting.AreaIndex = field.AreaIndex;
                fieldSetting.FieldName = field.FieldName;
                if (field.Area == PivotArea.RowArea)
                {
                    fieldSetting.PivotArea = 0;

                }
                else
                {
                    if (field.Area == PivotArea.ColumnArea)
                    {
                        fieldSetting.PivotArea = 1;
                    }
                    else
                    {
                        if (field.Area == PivotArea.FilterArea)
                        {
                            fieldSetting.PivotArea = 2;
                        }
                        else
                        {
                            fieldSetting.PivotArea = 3;
                        }
                    }
                }
                if (field.ValueFormat.FormatType == FormatType.Numeric || field.ValueFormat.FormatType == FormatType.DateTime)
                {
                    fieldSetting.CellFormat_FormatString = field.ValueFormat.FormatString;
                    fieldSetting.CellFormat_FormatType = field.ValueFormat.FormatType.ToString();
                }
                fieldSetting.Visible = field.Visible;
                fieldSettingList.Add(fieldSetting);
            }
            Session[CurrentUser.AccountId + "Layout"] = fieldSettingList;

        };

        if (pivotSetting != null && pivotSetting.Count > 0)
        {
            foreach (var fieldSetting in pivotSetting)
            {
                settings.Fields.Add(field =>
                {
                    if (fieldSetting.PivotArea == 0)
                    {
                        field.Area = PivotArea.RowArea;
                    }
                    if (fieldSetting.PivotArea == 1)
                    {
                        field.Area = PivotArea.ColumnArea;
                    }
                    if (fieldSetting.PivotArea == 2)
                    {
                        if (fieldSetting.AreaIndex > 10)
                        {
                            field.Visible = false;
                        }
                        field.Area = PivotArea.FilterArea;

                    }
                    if (fieldSetting.PivotArea == 3)
                    {
                        field.Area = PivotArea.DataArea;
                    }
                    field.FieldName = fieldSetting.FieldName;
                    field.Caption = fieldSetting.Caption;
                    field.AreaIndex = fieldSetting.AreaIndex.Value;
                    if (fieldSetting.CellFormat_FormatType == "DateTime")
                    {
                        field.ValueFormat.FormatType = FormatType.DateTime;
                        field.ValueFormat.FormatString = fieldSetting.CellFormat_FormatString;
                        field.CellFormat.FormatType = FormatType.DateTime;
                        field.CellFormat.FormatString = fieldSetting.CellFormat_FormatString;
                    }
                    if (fieldSetting.CellFormat_FormatType == "Numeric")
                    {
                        field.ValueFormat.FormatType = FormatType.Numeric;
                        field.ValueFormat.FormatString = fieldSetting.CellFormat_FormatString;
                        field.CellFormat.FormatType = FormatType.Numeric;
                        field.CellFormat.FormatString = fieldSetting.CellFormat_FormatString;
                        field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                        field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                    }
                    field.Visible = fieldSetting.Visible.Value;
                    field.SortMode = PivotSortMode.Default;
                });
            }
        }
        else // default
        {
            //Filter Area
            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "STT";
                field.Caption = "STT";
                field.AreaIndex = 0;
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n0}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n0}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Center;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "VBELN";
                field.Caption = "SO";
                field.AreaIndex = 1;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "PYCSXDT";
                field.Caption = "PYCSXDT";
                field.AreaIndex = 2;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "LSXDT";
                field.Caption = "LSX Đại Trà";
                field.AreaIndex = 3;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "DSX";
                field.Caption = "Đợt sản xuất";
                field.AreaIndex = 4;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "DeliveryDate";
                field.Caption = "Ngày giao hàng";
                field.ValueFormat.FormatString = "{0:dd/MM/yyyy}";
                field.ValueFormat.FormatType = FormatType.DateTime;
                field.AreaIndex = 5;
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Center;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "FinishDateChange";
                field.Caption = "Ngày KT điều chỉnh";
                field.ValueFormat.FormatString = "{0:dd/MM/yyyy}";
                field.ValueFormat.FormatType = FormatType.DateTime;
                field.AreaIndex = 6;
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Center;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "SLKH";
                field.Caption = "Số cont KH";
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n3}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n3}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                field.AreaIndex = 7;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "Remaining";
                field.Caption = "Số cont còn lại";
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n3}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n3}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                field.AreaIndex = 8;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "NK";
                field.Caption = "Đã NK";
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n3}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n3}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                field.AreaIndex = 9;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "AssignResponsibility";
                field.Caption = "Nhân sự phụ trách";
                field.AreaIndex = 10;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "Status";
                field.Caption = "Tình trạng";
                field.AreaIndex = 11;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "WorkShop";
                field.Caption = "Phân xưởng";
                field.AreaIndex = 12;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "Step1009";
                field.Caption = "4.1 Cấp Gỗ, Ván, Veneer";
                field.AreaIndex = 13;
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n3}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n3}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "Step1010";
                field.Caption = "4.2.1 Vật tư ráp chết (trước sơn)_RCTS";
                field.AreaIndex = 14;
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n3}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n3}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "Step1011";
                field.Caption = "4.2.2 Vật tư ráp chết sau sơn HOẶC đóng gói_RCSS/VTĐG";
                field.AreaIndex = 15;
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n3}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n3}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "Step1012";
                field.Caption = "4.3 Cấp Hoá chất";
                field.AreaIndex = 16;
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n3}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n3}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "Step1013";
                field.Caption = "4.4 Cấp BBPL";
                field.AreaIndex = 17;
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n3}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n3}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.RowArea;
                field.FieldName = "Step1014";
                field.Caption = "4.5 Gia công";
                field.AreaIndex = 18;
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n3}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n3}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            });

            //settings.Fields.Add(field =>
            //{
            //    field.Area = PivotArea.ColumnArea;
            //    field.FieldName = "Stock";
            //    field.Caption = "Công đoạn thực hiện";
            //    field.AreaIndex = 13;
            //    field.InnerGroupIndex = 0;
            //});

            //settings.Fields.Add(field =>
            //{
            //    field.Area = PivotArea.DataArea;
            //    field.FieldName = "CompletedPercent";
            //    field.Caption = "% hoàn thành";
            //    field.AreaIndex = 14;
            //    field.ValueFormat.FormatType = FormatType.Numeric;
            //    field.ValueFormat.FormatString = "{0:n2}";
            //    field.CellFormat.FormatType = FormatType.Numeric;
            //    field.CellFormat.FormatString = "{0:n2}";
            //    field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
            //    field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            //    field.ColumnValueLineCount = 1;
            //});

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.ColumnArea;
                field.FieldName = "WorkShopData";
                field.Caption = "Phân xưởng";
                field.AreaIndex = 21;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.DataArea;
                field.FieldName = "RemainingData";
                field.Caption = "Số cont còn lại";
                field.AreaIndex = 22;
                field.ValueFormat.FormatType = FormatType.Numeric;
                field.ValueFormat.FormatString = "{0:n3}";
                field.CellFormat.FormatType = FormatType.Numeric;
                field.CellFormat.FormatString = "{0:n3}";
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Right;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            });

            settings.Fields.Add(field =>
            {
                field.Area = PivotArea.DataArea;
                field.FieldName = "FinishDateChangeData";
                field.Caption = "Ngày KT điều chỉnh";
                field.AreaIndex = 23;
                field.ValueFormat.FormatString = "{0:dd/MM/yyyy}";
                field.ValueFormat.FormatType = FormatType.DateTime;
                field.ValueStyle.HorizontalAlign = HorizontalAlign.Center;
                field.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            });
        }
    }).Bind(Model).GetHtml()*@

