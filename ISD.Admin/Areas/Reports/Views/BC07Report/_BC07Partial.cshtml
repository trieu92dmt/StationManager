@using Newtonsoft.Json;
@using ISD.Repositories;
@using System.Drawing;

@model IEnumerable<BC07ReportViewModel>

@{
    var pivotSetting = (List<FieldSettingModel>)ViewBag.PivotSetting;
    var search = (BC07ReportViewModel)ViewBag.Search;
    var NumberOfFreezeColumn = (int?)ViewBag.NumberOfFreezeColumn;
    UtilitiesRepository repo = new UtilitiesRepository();
    string fileName = repo.RemoveSign4VietnameseString(LanguageResource.BC07Report.ToUpper()).Replace(" ", "_").Replace("/", "_");
    Html.EnableClientValidation();
    Html.EnableUnobtrusiveJavaScript();
}
@Html.DevExpress().GridView(settings =>
{
    settings.Name = "gridViewBC07";
    settings.KeyFieldName = "DSX";
    settings.Width = Unit.Percentage(100);
    settings.CallbackRouteValues = new { Controller = "BC07Report", Action = "BC07ReportPartial", jsonReq = JsonConvert.SerializeObject(search) };
    //Command Column: CRUD
    settings.CommandColumn.Visible = false;

    //Fixed Column
    settings.Styles.FixedColumn.BackColor = Color.LightYellow;
    settings.Settings.HorizontalScrollBarMode = ScrollBarMode.Visible;

    //Fixed Header
    settings.Settings.VerticalScrollBarMode = ScrollBarMode.Visible;
    settings.Settings.VerticalScrollableHeight = 500;

    settings.SettingsPager.Mode = GridViewPagerMode.ShowAllRecords;

    settings.Columns.Add(c =>
    {
        c.FieldName = "STT";
        c.Width = Unit.Pixel(50);
        c.Caption = "STT";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 50;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "AssignResponsibility";
        c.Width = Unit.Pixel(120);
        c.Caption = "PIC_TDSX, XH";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 120;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "Customer";
        c.Width = Unit.Pixel(100);
        c.Caption = "Khách hàng";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 100;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "PYCSXDT";
        c.Width = Unit.Pixel(120);
        c.Caption = "Phiếu YCSXĐT";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 120;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "LSXDT";
        c.Width = Unit.Pixel(180);
        c.Caption = "LSXĐT";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 180;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "DSX";
        c.Width = Unit.Pixel(180);
        c.Caption = "LSXĐT-Đợt";
        c.FixedStyle = GridViewColumnFixedStyle.Left;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 180;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "VBELN";
        c.Width = Unit.Pixel(100);
        c.Caption = "SO SAP";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 100;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "PONoiBo";
        c.Width = Unit.Pixel(100);
        c.Caption = "PO nội bộ";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 100;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SoPOKhach";
        c.Width = Unit.Pixel(120);
        c.Caption = "Số PO Khách";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 120;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "MaSKU";
        c.Width = Unit.Pixel(90);
        c.Caption = "Mã SKU/ Mã SP KH";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 90;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "ProductName";
        c.Width = Unit.Pixel(200);
        c.Caption = "Tên sản phẩm";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 200;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "ProductCode";
        c.Width = Unit.Pixel(100);
        c.Caption = "Mã SP (SAP)";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 100;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "LSXSAP";
        c.Width = Unit.Pixel(100);
        c.Caption = "LSX SAP";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 100;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "WBS";
        c.Width = Unit.Pixel(150);
        c.Caption = "WBS";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 150;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "TinhTrangMT";
        c.Width = Unit.Pixel(90);
        c.Caption = "Tình trạng MT";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 90;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "NguyenLieu";
        c.Width = Unit.Pixel(150);
        c.Caption = "Nguyên liệu";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 150;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "HoanThien";
        c.Width = Unit.Pixel(200);
        c.Caption = "Hoàn thiện";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 200;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "HinhAnh";
        c.Width = Unit.Pixel(90);
        c.Caption = "Hình ảnh";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 90;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "DVT";
        c.Width = Unit.Pixel(50);
        c.Caption = "ĐVT";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 50;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLKH";
        c.Width = Unit.Pixel(70);
        c.Caption = "SLKH";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n0";
        c.ExportWidth = 70;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLDaNK";
        c.Width = Unit.Pixel(90);
        c.Caption = "SL đã nhập kho";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n0";
        c.ExportWidth = 90;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLChuaNK";
        c.Width = Unit.Pixel(90);
        c.Caption = "SL chưa nhập kho";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n0";
        c.ExportWidth = 90;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLDaXuat";
        c.Width = Unit.Pixel(90);
        c.Caption = "SL đã xuất";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n0";
        c.ExportWidth = 90;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLChuaXuat";
        c.Width = Unit.Pixel(90);
        c.Caption = "SL chưa xuất";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n0";
        c.ExportWidth = 90;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLTonKho";
        c.Width = Unit.Pixel(100);
        c.Caption = "SL tồn kho";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n0";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SoContKH";
        c.Width = Unit.Pixel(100);
        c.Caption = "Số cont KH";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SoContDaNK";
        c.Width = Unit.Pixel(100);
        c.Caption = "Số cont đã nhập kho";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SoContChuaNK";
        c.Width = Unit.Pixel(100);
        c.Caption = "Số cont chưa nhập kho";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SoContDaXuat";
        c.Width = Unit.Pixel(100);
        c.Caption = "Số cont đã xuất";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SoContChuaXuat";
        c.Width = Unit.Pixel(100);
        c.Caption = "Số cont chưa xuất";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SoContTonKho";
        c.Width = Unit.Pixel(100);
        c.Caption = "Số cont tồn kho";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "NgayKTDKTheoLSXSAP";
        c.Width = Unit.Pixel(100);
        c.Caption = "Ngày hoàn thành theo LSX SAP";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "NgayKTDKTheoDSX";
        c.Width = Unit.Pixel(100);
        c.Caption = "Ngày HT KH LXS-Đợt";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "NgayKTDCTheoDSX";
        c.Width = Unit.Pixel(100);
        c.Caption = "Ngày hoàn thành điều chỉnh LSX-Đợt";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLSP";
        c.Width = Unit.Pixel(80);
        c.Caption = "SLSP/ Carton";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n0";
        c.ExportWidth = 80;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CBM";
        c.Width = Unit.Pixel(80);
        c.Caption = "CBM/ Carton";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 80;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "TongCBMChuaXuat";
        c.Width = Unit.Pixel(80);
        c.Caption = "Tổng CBM chưa xuất";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n3";
        c.ExportWidth = 80;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CangDen";
        c.Width = Unit.Pixel(80);
        c.Caption = "Cảng đến";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 80;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "LoaiCont";
        c.Width = Unit.Pixel(80);
        c.Caption = "Loại cont (HC DC LCL)";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 80;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "NgayTauChay";
        c.Width = Unit.Pixel(80);
        c.Caption = "Ngày tàu chạy (ETD)";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 80;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "StartSWDate";
        c.Width = Unit.Pixel(80);
        c.Caption = "Start SW date";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 80;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "EndSWDate";
        c.Width = Unit.Pixel(80);
        c.Caption = "End SW date";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 80;
    });
    //settings.Columns.Add(c =>
    //{
    //    c.FieldName = "StartSWDate";
    //    c.Width = Unit.Pixel(100);
    //    c.Caption = "Start SW date";
    //    c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
    //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    //    c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
    //    c.ExportWidth = 100;
    //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    //});

    //settings.Columns.Add(c =>
    //{
    //    c.FieldName = "EndSWDate";
    //    c.Width = Unit.Pixel(100);
    //    c.Caption = "End SW date";
    //    c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
    //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    //    c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
    //    c.ExportWidth = 100;
    //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    //});

    settings.Columns.Add(c =>
    {
        c.FieldName = "AustinDirect";
        c.Width = Unit.Pixel(80);
        c.Caption = "Austin/ Direct";
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportWidth = 80;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "TuanXuatHang";
        c.Width = Unit.Pixel(80);
        c.Caption = "Tuần xuất hàng";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n0";
        c.ExportWidth = 80;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "ThangXuatHang";
        c.Width = Unit.Pixel(80);
        c.Caption = "Tháng xuất hàng";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "n0";
        c.ExportWidth = 80;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "NgayYeuCauXuatHangSO";
        c.Width = Unit.Pixel(100);
        c.Caption = "Ngày yêu cầu xuất hàng theo SO (SAP)";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentGo";
        c.Width = Unit.Pixel(100);
        c.Caption = "Gỗ";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentVan";
        c.Width = Unit.Pixel(100);
        c.Caption = "Ván, veneer";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentGiaCong";
        c.Width = Unit.Pixel(100);
        c.Caption = "Gia công";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentVatTu";
        c.Width = Unit.Pixel(100);
        c.Caption = "Vật tư";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentHoaChat";
        c.Width = Unit.Pixel(100);
        c.Caption = "Hóa chất";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "CompletedPercentBBPL";
        c.Width = Unit.Pixel(100);
        c.Caption = "BBPL, tem nhãn";
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
        c.ExportWidth = 100;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    });

    //settings.Columns.Add(c =>
    //{
    //    c.FieldName = "CompletedPercentBangMau";
    //    c.Width = Unit.Pixel(100);
    //    c.Caption = "Bảng màu";
    //    c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
    //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    //    c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
    //    c.ExportWidth = 100;
    //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
    //});

    //Phân xưởng phôi
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX Phôi";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXP_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        //orderBand.Columns.Add(c =>
        //{
        //    c.FieldName = "PXP_SoContHT";
        //    c.Width = Unit.Pixel(80);
        //    c.ExportWidth = 80;
        //    c.Caption = "Số cont HT";
        //    c.ReadOnly = true;
        //    c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        //    c.PropertiesEdit.DisplayFormatString = "n3";
        //    c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        //});

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "KLTGo";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "M3 tinh gỗ";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXP_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXP_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXP_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng mẫu
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX Mẫu";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXM_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        //orderBand.Columns.Add(c =>
        //{
        //    c.FieldName = "PXM_SoContHT";
        //    c.Width = Unit.Pixel(80);
        //    c.ExportWidth = 80;
        //    c.Caption = "Số cont HT";
        //    c.ReadOnly = true;
        //    c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        //    c.PropertiesEdit.DisplayFormatString = "n3";
        //    c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        //});

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXM_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXM_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXM_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 3
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX3";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX3_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        //orderBand.Columns.Add(c =>
        //{
        //    c.FieldName = "PX3_SoContHT";
        //    c.Width = Unit.Pixel(80);
        //    c.ExportWidth = 80;
        //    c.Caption = "Số cont HT";
        //    c.ReadOnly = true;
        //    c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        //    c.PropertiesEdit.DisplayFormatString = "n3";
        //    c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        //});

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX3_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX3_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX3_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 6
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX6";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX6_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        //orderBand.Columns.Add(c =>
        //{
        //    c.FieldName = "PX6_SoContHT";
        //    c.Width = Unit.Pixel(80);
        //    c.ExportWidth = 80;
        //    c.Caption = "Số cont HT";
        //    c.ReadOnly = true;
        //    c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        //    c.PropertiesEdit.DisplayFormatString = "n3";
        //    c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        //});

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX6_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX6_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX6_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 4
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX4";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX4_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX4_SoContHT";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont HT";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        //orderBand.Columns.Add(c =>
        //{
        //    c.FieldName = "PX4_SoContConLai";
        //    c.Width = Unit.Pixel(80);
        //    c.ExportWidth = 80;
        //    c.Caption = "Số cont còn lại";
        //    c.ReadOnly = true;
        //    c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        //    c.PropertiesEdit.DisplayFormatString = "n3";
        //    c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        //});

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX4_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX4_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 5
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX5";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX5_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        //orderBand.Columns.Add(c =>
        //{
        //    c.FieldName = "PX5_SoContHT";
        //    c.Width = Unit.Pixel(80);
        //    c.ExportWidth = 80;
        //    c.Caption = "Số cont HT";
        //    c.ReadOnly = true;
        //    c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        //    c.PropertiesEdit.DisplayFormatString = "n3";
        //    c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        //});

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX5_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX5_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX5_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng Cửa
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX Cửa";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXC_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        //orderBand.Columns.Add(c =>
        //{
        //    c.FieldName = "PXC_SoContHT";
        //    c.Width = Unit.Pixel(80);
        //    c.ExportWidth = 80;
        //    c.Caption = "Số cont HT";
        //    c.ReadOnly = true;
        //    c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        //    c.PropertiesEdit.DisplayFormatString = "n3";
        //    c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        //});

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXC_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXC_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PXC_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 1
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX1";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX1_SoContKH";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont KH";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        //orderBand.Columns.Add(c =>
        //{
        //    c.FieldName = "PX1_SoContHT";
        //    c.Width = Unit.Pixel(80);
        //    c.ExportWidth = 80;
        //    c.Caption = "Số cont HT";
        //    c.ReadOnly = true;
        //    c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        //    c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        //    c.PropertiesEdit.DisplayFormatString = "n3";
        //    c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        //});

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX1_SoContConLai";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Số cont còn lại";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "n3";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX1_NgayYCHT";
            c.Width = Unit.Pixel(100);
            c.ExportWidth = 100;
            c.Caption = "Ngày yêu cầu hoàn thành";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "PX1_TinhTrang";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Tình trạng (%)";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
            c.PropertiesEdit.DisplayFormatString = "{0:n2} %";
            c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Filter
    settings.Settings.ShowHeaderFilterButton = true;
    settings.SettingsPopup.HeaderFilter.Height = 200;
    settings.SettingsPopup.HeaderFilter.SettingsAdaptivity.MinHeight = 300;
    //var headerFilterMode = GridHeaderFilterMode.CheckedList;
    //foreach (GridViewDataColumn column in settings.Columns)
    //{
    //    column.SettingsHeaderFilter.Mode = headerFilterMode;
    //}

    //Export excel
    if (Model != null && Model.Count() > 0)
    {
        settings.SettingsExport.EnableClientSideExportAPI = true;
        settings.SettingsExport.ExcelExportMode = DevExpress.Export.ExportType.WYSIWYG;

        settings.Toolbars.Add(t =>
        {
            t.SettingsAdaptivity.Enabled = true;
            t.SettingsAdaptivity.EnableCollapseRootItemsToIcons = true;
            t.Items.Add(GridViewToolbarCommand.ExportToXls);
            t.Items.Add(GridViewToolbarCommand.ExportToXlsx);
        });

        //File name
        settings.SettingsExport.FileName = fileName;
        //Page header
        //settings.SettingsExport.ReportHeader = LanguageResource.BC00Report.ToUpper();
        settings.SettingsExport.PageHeader.Left = LanguageResource.BC07Report.ToUpper();
        settings.SettingsExport.PageHeader.Font.Size = 16;
        settings.SettingsExport.PageHeader.Font.Bold = true;
        //Column header
        settings.SettingsExport.Styles.Header.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        settings.SettingsExport.Styles.Header.ForeColor = ColorTranslator.FromHtml("#000000");
        settings.SettingsExport.Styles.Header.Font.Size = 11;
        settings.SettingsExport.Styles.Header.Font.Bold = true;
        //Cell
        settings.SettingsExport.Styles.Cell.Font.Size = 11;
    }
    Reports.Helpers.GridViewFeaturesHelper.SetupGlobalGridViewBehavior(settings);
}).Bind(Model).GetHtml()


