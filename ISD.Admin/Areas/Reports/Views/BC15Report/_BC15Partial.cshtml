@using Newtonsoft.Json;
@using Reports.Options;
@using System.Drawing;
@using ISD.Repositories;

@model IEnumerable<BC15ReportViewModel>

@{
    var pivotSetting = (List<FieldSettingModel>)ViewBag.PivotSetting;
    var search = (BC15ReportViewModel)ViewBag.Search;
    int NumberOfFreezeColumn = 5;
    UtilitiesRepository repo = new UtilitiesRepository();
    string fileName = repo.RemoveSign4VietnameseString(LanguageResource.BC15Report.ToUpper()).Replace(" ", "_").Replace("/", "_");
    Html.EnableClientValidation();
    Html.EnableUnobtrusiveJavaScript();
    //4 công đoạn lớn
    string Step1Code = (string)ViewBag.Step1Code;
    string Step2Code = (string)ViewBag.Step2Code;
    string Step3Code = (string)ViewBag.Step3Code;
    string Step4Code = (string)ViewBag.Step4Code;
}

@Html.DevExpress().GridView(settings =>
{
    settings.Name = "gridViewBC15";
    settings.KeyFieldName = "BC01Id";
    settings.Width = Unit.Percentage(100);
    settings.CallbackRouteValues = new { Controller = "BC15Report", Action = "BC15Partial", jsonReq = JsonConvert.SerializeObject(search) };
    //settings.SettingsEditing.BatchUpdateRouteValues = new { Controller = "BC15Report", Action = "BatchEditingUpdateModel" };

    //Command Column: CRUD
    settings.CommandColumn.Visible = false;
    /*
    //settings.CommandColumn.ShowCancelButton = true;
    //settings.CommandColumn.ShowDeleteButton = true;
    //settings.CommandColumn.ShowNewButtonInHeader = false;
    //settings.CommandColumn.ShowNewButton = true;
    settings.CommandColumn.Width = Unit.Pixel(90);
    settings.CommandColumn.FixedStyle = GridViewColumnFixedStyle.Left;
    settings.CommandColumn.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    //Button sửa
    settings.CommandColumn.CustomButtons.Add(new GridViewCommandColumnCustomButton() { ID = "btn-edit-row", Text = "Sửa" });
    settings.ClientSideEvents.CustomButtonClick = "function(s, e) {{ if(e.buttonID == 'btn-edit-row') { handleEditReportModalPopup(s, e) } }}";
    */
    //Fixed Column
    settings.Styles.FixedColumn.BackColor = Color.LightYellow;
    settings.Settings.HorizontalScrollBarMode = ScrollBarMode.Visible;

    //Fixed Header
    settings.Settings.VerticalScrollBarMode = ScrollBarMode.Visible;
    settings.Settings.VerticalScrollableHeight = 500;

    settings.SettingsPager.Mode = GridViewPagerMode.ShowAllRecords;

    //Paging
    //settings.SettingsPager.Position = PagerPosition.TopAndBottom;
    //settings.SettingsPager.FirstPageButton.Visible = true;
    //settings.SettingsPager.LastPageButton.Visible = true;
    //settings.SettingsPager.PageSizeItemSettings.Visible = true;
    //settings.SettingsPager.PageSizeItemSettings.Items = new string[] { "10", "20", "50", "100", "200" };

    settings.Columns.Add(c =>
    {
        c.FieldName = "WorkShopName";
        c.Width = Unit.Pixel(150);
        c.ExportWidth = 150;
        c.Caption = "Phân xưởng";
        c.ReadOnly = true;
        //c.EditorProperties().SpinEdit(p =>
        //{
        //    p.DisplayFormatString = "n2";
        //});
        //c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        //c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        if (NumberOfFreezeColumn > 0)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "LSXSAP";
        c.Width = Unit.Pixel(100);
        c.ExportWidth = 100;
        c.Caption = "LSX SAP";
        c.ReadOnly = true;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        if (NumberOfFreezeColumn > 1)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "LSX";
        c.Width = Unit.Pixel(200);
        c.ExportWidth = 200;
        c.Caption = "LSXĐT đợt";
        c.ReadOnly = true;
        if (NumberOfFreezeColumn > 2)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "ProductCode";
        c.Width = Unit.Pixel(100);
        c.ExportWidth = 100;
        c.Caption = "Mã SP";
        c.ReadOnly = true;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        if (NumberOfFreezeColumn > 3)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "ProductName";
        c.Width = Unit.Pixel(200);
        c.ExportWidth = 200;
        c.Caption = "Tên SP";
        c.ReadOnly = true;
        if (NumberOfFreezeColumn > 4)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "ProductAttributes";
        c.Width = Unit.Pixel(90);
        c.ExportWidth = 90;
        c.Caption = "STT";
        c.ReadOnly = true;
        if (NumberOfFreezeColumn > 5)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "ProductAttributesName";
        c.Width = Unit.Pixel(200);
        c.ExportWidth = 200;
        c.Caption = "Tên chi tiết";
        c.ReadOnly = true;
        if (NumberOfFreezeColumn > 6)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "MaterialCode";
        c.Width = Unit.Pixel(100);
        c.ExportWidth = 100;
        c.Caption = "Mã SAP";
        c.ReadOnly = true;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        if (NumberOfFreezeColumn > 7)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "MaterialName";
        c.Width = Unit.Pixel(200);
        c.ExportWidth = 200;
        c.Caption = "Nguyên liệu";
        c.ReadOnly = true;
        if (NumberOfFreezeColumn > 8)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "DVT";
        c.Width = Unit.Pixel(90);
        c.ExportWidth = 90;
        c.Caption = "ĐVT";
        c.ReadOnly = true;
        if (NumberOfFreezeColumn > 9)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLCTKH";
        c.Width = Unit.Pixel(100);
        c.ExportWidth = 100;
        c.Caption = "SL chi tiết/SP";
        c.ReadOnly = true;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Right;
        c.PropertiesEdit.DisplayFormatString = "n0";
        if (NumberOfFreezeColumn > 10)
        {
            c.FixedStyle = GridViewColumnFixedStyle.Left;
        }
    });

    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "Quy cách tinh(mm)";

        orderBand.Columns.Add(c =>
        {
            c.FieldName = "P1";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Dày";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Right;
            c.PropertiesEdit.DisplayFormatString = "n0";
        });
        orderBand.Columns.Add(c =>
        {
            c.FieldName = "P2";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Rộng";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Right;
            c.PropertiesEdit.DisplayFormatString = "n0";
        });
        orderBand.Columns.Add(c =>
        {
            c.FieldName = "P3";
            c.Width = Unit.Pixel(80);
            c.ExportWidth = 80;
            c.Caption = "Dài";
            c.ReadOnly = true;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.HeaderStyle.HorizontalAlign = HorizontalAlign.Right;
            c.PropertiesEdit.DisplayFormatString = "n0";
        });
        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "TheTich";
        c.Width = Unit.Pixel(80);
        c.ExportWidth = 80;
        c.Caption = "V(m3)";
        c.ReadOnly = true;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Right;
        c.PropertiesEdit.DisplayFormatString = "n3";
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "KLTGo";
        c.Width = Unit.Pixel(80);
        c.ExportWidth = 80;
        c.Caption = "KL tinh Gỗ";
        c.ReadOnly = true;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Right;
        c.PropertiesEdit.DisplayFormatString = "n3";
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "KLTVan";
        c.Width = Unit.Pixel(80);
        c.ExportWidth = 80;
        c.Caption = "KL tinh Ván";
        c.ReadOnly = true;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Right;
        c.PropertiesEdit.DisplayFormatString = "n3";
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLKH";
        c.Width = Unit.Pixel(80);
        c.ExportWidth = 80;
        c.Caption = "SL sản phẩm theo LSX";
        c.ReadOnly = true;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Right;
        c.PropertiesEdit.DisplayFormatString = "n0";
    });

    settings.Columns.Add(c =>
    {
        c.FieldName = "SLCTKHTheoSP";
        c.Width = Unit.Pixel(80);
        c.ExportWidth = 80;
        c.Caption = "SLCTKH";
        c.ReadOnly = true;
        c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
        c.HeaderStyle.HorizontalAlign = HorizontalAlign.Right;
        c.PropertiesEdit.DisplayFormatString = "n0";
    });

    //Phân xưởng phôi
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX Phôi";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXP_SLHT_SC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step1Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXP_SLCL_SC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step1Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số phút NCTT";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXP_SoPhutNCTT_SC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step1Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n2";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont KH";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXP_SoContKH_SC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step1Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n3";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXP_SoContConLai_SC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step1Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n3";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Ngày yêu cầu hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXP_NgayYCHT_SC";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step1Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Tình trạng LSX";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXP_TinhTrang_SC";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step1Code;
                c.ReadOnly = true;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 3
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX 3";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX3_SLHT_TC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step2Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX3_SLCL_TC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step2Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX3_SLHT_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX3_SLCL_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số phút NCTT";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX3_SoPhutNCTT_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n2";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont KH";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX3_SoContKH_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n3";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX3_SoContConLai_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n3";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Ngày yêu cầu hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX3_NgayYCHT_LR";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Tình trạng LSX";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX3_TinhTrang_LR";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 6
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX 6";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX6_SLHT_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX6_SLCL_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số phút NCTT";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX6_SoPhutNCTT_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n2";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont KH";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX6_SoContKH_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n3";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX6_SoContConLai_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n3";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Ngày yêu cầu hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX6_NgayYCHT_HT";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Tình trạng LSX";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX6_TinhTrang_HT";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 4
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX 4";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX4_SLHT_TC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step2Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX4_SLCL_TC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step2Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX4_SLHT_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX4_SLCL_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số phút NCTT";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX4_SoPhutNCTT_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n2";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont KH";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX4_SoContKH_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n4";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX4_SoContConLai_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n4";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Ngày yêu cầu hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX4_NgayYCHT_LR";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Tình trạng LSX";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX4_TinhTrang_LR";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng 5
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX 5";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX5_SLHT_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX5_SLCL_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số phút NCTT";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX5_SoPhutNCTT_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n2";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont KH";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX5_SoContKH_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n3";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX5_SoContConLai_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n3";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Ngày yêu cầu hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX5_NgayYCHT_HT";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Tình trạng LSX";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PX5_TinhTrang_HT";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng Cửa
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX Cửa";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_SLHT_TC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step2Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_SLCL_TC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step2Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_SLHT_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_SLCL_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_SLHT_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_SLCL_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số phút NCTT";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_SoPhutNCTT_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n2";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont KH";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_SoContKH_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n4";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_SoContConLai_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n4";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Ngày yêu cầu hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_NgayYCHT_HT";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Tình trạng LSX";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXCua_TinhTrang_HT";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#C6EFCE");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //Phân xưởng Mẫu
    settings.Columns.AddBand(orderBand =>
    {
        orderBand.Caption = "PX Mẫu";
        orderBand.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SLHT_SC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step1Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SLCL_SC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step1Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SLHT_TC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step2Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SLCL_TC";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step2Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SLHT_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SLCL_LR";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step3Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SLHT_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số lượng còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SLCL_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n0";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số phút NCTT";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SoPhutNCTT_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n2";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont KH";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SoContKH_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n3";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Số cont còn lại";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_SoContConLai_HT";
                c.Width = Unit.Pixel(80);
                c.ExportWidth = 80;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Right;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "n3";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Ngày yêu cầu hoàn thành";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_NgayYCHT_HT";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.ExportCellStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.Columns.AddBand(orderBandItem =>
        {
            orderBandItem.Caption = "Tình trạng LSX";
            orderBandItem.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");

            orderBandItem.Columns.Add(c =>
            {
                c.FieldName = "PXMau_TinhTrang_HT";
                c.Width = Unit.Pixel(100);
                c.ExportWidth = 100;
                c.Caption = Step4Code;
                c.ReadOnly = true;
                c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
                c.HeaderStyle.BackColor = ColorTranslator.FromHtml("#DDEBF7");
            });
            orderBandItem.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
        });

        orderBand.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
    });

    //settings.Columns.Add("Discontinued", MVCxGridViewColumnType.CheckBox);
    settings.CellEditorInitialize = (s, e) =>
    {
        ASPxEdit editor = (ASPxEdit)e.Editor;
        editor.ValidationSettings.Display = Display.None;
    };
    settings.ClientSideEvents.BeginCallback = "OnBeginGridCallback";

    //Filter
    settings.Settings.ShowHeaderFilterButton = true;
    settings.SettingsPopup.HeaderFilter.Height = 200;
    settings.SettingsPopup.HeaderFilter.SettingsAdaptivity.MinHeight = 300;
    //var headerFilterMode = GridHeaderFilterMode.CheckedList;
    //foreach (GridViewDataColumn column in settings.Columns)
    //{
    //    column.SettingsHeaderFilter.Mode = headerFilterMode;
    //}

    //Export excel
    if (Model != null && Model.Count() > 0)
    {
        settings.SettingsExport.EnableClientSideExportAPI = true;
        settings.SettingsExport.ExcelExportMode = DevExpress.Export.ExportType.WYSIWYG;

        settings.Toolbars.Add(t =>
        {
            t.SettingsAdaptivity.Enabled = true;
            t.SettingsAdaptivity.EnableCollapseRootItemsToIcons = true;
            t.Items.Add(GridViewToolbarCommand.ExportToXls);
            t.Items.Add(GridViewToolbarCommand.ExportToXlsx);
        });

        //File name
        settings.SettingsExport.FileName = fileName;
        //Page header
        //settings.SettingsExport.ReportHeader = LanguageResource.BC15Report.ToUpper();
        settings.SettingsExport.PageHeader.Left = LanguageResource.BC15Report.ToUpper();
        settings.SettingsExport.PageHeader.Font.Size = 16;
        settings.SettingsExport.PageHeader.Font.Bold = true;
        //Column header
        settings.SettingsExport.Styles.Header.BackColor = ColorTranslator.FromHtml("#C6EFCE");
        settings.SettingsExport.Styles.Header.ForeColor = ColorTranslator.FromHtml("#000000");
        settings.SettingsExport.Styles.Header.Font.Size = 11;
        settings.SettingsExport.Styles.Header.Font.Bold = true;
        //Cell
        settings.SettingsExport.Styles.Cell.Font.Size = 11;
    }


    Reports.Helpers.GridViewFeaturesHelper.SetupGlobalGridViewBehavior(settings);
}).Bind(Model).GetHtml()